#!/usr/bin/env bash
set -euo pipefail

here="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Prefer a local venv so users don't need to activate it.
if [[ -x "${here}/.venv/bin/python" ]]; then
  py="${here}/.venv/bin/python"
elif [[ -x "${here}/venv/bin/python" ]]; then
  py="${here}/venv/bin/python"
else
  echo "ERROR: venv not found. Create one at ./.venv or ./venv." >&2
  echo "Example:" >&2
  echo "  python3 -m venv .venv && . .venv/bin/activate && pip install -U pip" >&2
  echo "  pip install numpy torch torchaudio webrtcvad faster-whisper" >&2
  exit 1
fi

exec "${py}" "${here}/diarise.py" "$@"
